---
phase: 36-developer-skills
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/skills/cocosearch/SKILL.md
autonomous: true

must_haves:
  truths:
    - "Claude Code skill file exists and loads without errors"
    - "Skill includes working MCP configuration for stdio transport"
    - "Skill includes decision tree for when to use CocoSearch vs grep/ripgrep"
    - "Skill includes 5+ workflow examples with expected output"
  artifacts:
    - path: ".claude/skills/cocosearch/SKILL.md"
      provides: "Claude Code skill documentation"
      min_lines: 80
      contains: "mcpServers"
  key_links:
    - from: ".claude/skills/cocosearch/SKILL.md"
      to: "README.md"
      via: "troubleshooting reference"
      pattern: "README.md|troubleshooting"
---

<objective>
Create Claude Code skill for CocoSearch with installation instructions, MCP configuration, and routing guidance.

Purpose: Help Claude Code users set up CocoSearch and know when to use semantic search vs grep/ripgrep/IDE tools.
Output: SKILL.md file (~100 lines) in .claude/skills/cocosearch/ directory
</objective>

<execution_context>
@/Users/fedorzhdanov/.claude/get-shit-done/workflows/execute-plan.md
@/Users/fedorzhdanov/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/36-developer-skills/36-CONTEXT.md
@.planning/phases/36-developer-skills/36-RESEARCH.md
@README.md (lines 457-600 for MCP config examples)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Claude Code skill directory and SKILL.md</name>
  <files>.claude/skills/cocosearch/SKILL.md</files>
  <action>
Create `.claude/skills/cocosearch/SKILL.md` with the following structure (~100 lines, compact format):

**Frontmatter:**
```yaml
---
name: cocosearch
description: Semantic code search via MCP. Use for understanding unfamiliar code, finding related functionality, or exploring symbol hierarchies.
---
```

**Sections (in order):**

1. **Quick Setup** (~15 lines)
   - UV installation: `curl -LsSf https://astral.sh/uv/install.sh | sh`
   - CocoSearch installation: `uv pip install cocosearch`
   - Point to MCP Configuration section

2. **MCP Configuration** (~25 lines)
   - Show Claude CLI method (preferred):
     ```bash
     claude mcp add --transport stdio --scope user \
       --env COCOSEARCH_DATABASE_URL=postgresql://cocoindex:cocoindex@localhost:5432/cocoindex \
       cocosearch -- uv run --directory /absolute/path/to/cocosearch cocosearch mcp
     ```
   - Show JSON config alternative (~/.claude.json):
     ```json
     {
       "mcpServers": {
         "cocosearch": {
           "command": "uv",
           "args": ["run", "--directory", "/path/to/cocosearch", "cocosearch", "mcp"],
           "env": {
             "COCOSEARCH_DATABASE_URL": "postgresql://cocoindex:cocoindex@localhost:5432/cocoindex"
           }
         }
       }
     }
     ```
   - Verification: `cocosearch stats` confirms connection

3. **When to Use CocoSearch** (~20 lines) - Decision tree format:
   - **Use CocoSearch for:**
     - Intent-based discovery: "find authentication logic"
     - Symbol exploration: `--symbol-type function` filters
     - Cross-file patterns: "error handling patterns"
     - Context expansion: `--smart` shows full function
   - **Use grep/ripgrep for:**
     - Exact identifiers: `rg "getUserById"`
     - Regex patterns: `rg "TODO:.*urgent"`
     - Known location searches
   - **Use IDE tools for:**
     - Go-to-definition (Cmd+Click)
     - Find-references
     - Rename refactoring

4. **Workflow Examples** (~35 lines) - 5+ examples with truncated output:
   - Semantic discovery: `cocosearch search "database connection handling"`
   - Hybrid + symbol: `cocosearch search "authenticate" --hybrid --symbol-type function`
   - Context expansion: `cocosearch search "error handler" -C 10`
   - Language filter: `cocosearch search "API routes" --lang typescript`
   - Symbol name filter: `cocosearch search "User" --symbol-name "User*"`

   Each example shows: command + expected output (first result fully, second truncated with [...])

5. **Anti-Patterns** (~5 lines):
   - Don't use for: exact string matches, regex, single-file edits
   - Don't forget: reindex after major changes

**Footer:** Reference README.md for troubleshooting and advanced setup (Docker, all-in-one container)

**Tone:** Direct, terse, bullet points. No prose paragraphs.
  </action>
  <verify>
File exists: `ls -la .claude/skills/cocosearch/SKILL.md`
Line count: `wc -l .claude/skills/cocosearch/SKILL.md` (should be 80-120 lines)
Contains key sections: `grep -c "MCP Configuration\|When to Use\|Workflow Examples" .claude/skills/cocosearch/SKILL.md` (should be 3)
Contains decision tree: `grep -c "Use CocoSearch for\|Use grep" .claude/skills/cocosearch/SKILL.md` (should be >= 2)
  </verify>
  <done>
Claude Code SKILL.md exists at .claude/skills/cocosearch/SKILL.md with:
- Frontmatter with name and description
- MCP configuration for stdio transport (CLI + JSON options)
- Decision tree routing guidance
- 5+ workflow examples with expected output
- Reference to README.md for troubleshooting
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify skill structure and content completeness</name>
  <files>.claude/skills/cocosearch/SKILL.md</files>
  <action>
Validate the created SKILL.md meets all requirements:

1. **Frontmatter validation:**
   - Has valid YAML frontmatter with name and description
   - Description is under 100 characters for context budget

2. **Content validation:**
   - Contains MCP configuration with correct JSON structure
   - Contains decision tree with explicit "if X, use Y" format
   - Contains at least 5 distinct workflow examples
   - Each example has command + expected output snippet
   - References README.md for troubleshooting (not duplicated)

3. **Format validation:**
   - Total lines between 80-120 (compact format)
   - Bullet point format (minimal prose)
   - No troubleshooting section (deferred to README)

If any validation fails, update the file to fix issues.
  </action>
  <verify>
Frontmatter: `head -5 .claude/skills/cocosearch/SKILL.md` shows valid YAML
Examples count: `grep -c "cocosearch search" .claude/skills/cocosearch/SKILL.md` >= 5
README reference: `grep -c "README" .claude/skills/cocosearch/SKILL.md` >= 1
No troubleshooting section: `grep -c "Troubleshooting" .claude/skills/cocosearch/SKILL.md` should be 0
  </verify>
  <done>
SKILL.md passes all validation:
- Valid frontmatter with concise description
- Complete MCP config with stdio transport
- Decision tree with routing guidance
- 5+ examples with output snippets
- README reference for troubleshooting
- Compact format (80-120 lines)
  </done>
</task>

</tasks>

<verification>
1. File exists: `ls .claude/skills/cocosearch/SKILL.md`
2. Frontmatter valid: `head -10 .claude/skills/cocosearch/SKILL.md` shows YAML block
3. MCP config present: `grep "mcpServers" .claude/skills/cocosearch/SKILL.md` matches
4. Decision tree present: `grep -A 5 "When to Use" .claude/skills/cocosearch/SKILL.md` shows routing
5. Examples present: `grep -c "cocosearch search" .claude/skills/cocosearch/SKILL.md` >= 5
6. Compact format: `wc -l .claude/skills/cocosearch/SKILL.md` between 80-120
</verification>

<success_criteria>
- Claude Code skill file exists at .claude/skills/cocosearch/SKILL.md
- Skill loads without YAML errors (valid frontmatter)
- Skill includes MCP configuration for stdio transport with both CLI and JSON options
- Skill includes decision tree: when to use CocoSearch vs grep vs IDE
- Skill includes 5+ workflow examples with commands and expected output
- Skill references README.md for troubleshooting (no duplication)
- Skill is compact (~100 lines, bullet point format)
</success_criteria>

<output>
After completion, create `.planning/phases/36-developer-skills/36-01-SUMMARY.md`
</output>
